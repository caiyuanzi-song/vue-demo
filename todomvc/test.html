<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/todomvc-common/base.css">
	<link rel="stylesheet" href="css/todomvc-app-css/index.css">
    <title>Document</title>
</head>
<body>
   <section class="todoapp" id="todoapp">
       <header class="header">
           <h1>todos</h1>
           <input class="new-todo" autocomplete="off" placeholder="what needs to be done?" autofocus @keyup.enter="addItem">
       </header>
       <section class="main" v-show="items.length">
           <input type="checkbox" name="" id="toggle-all" class="toggle-all" v-model="toggleAll">
           <label for="toggle-all">Mark all as complete</label>
           <ul class="todo-list">
               <li  class="todo" v-for="(item,index) in items" :class="{completed: item.completed,editing: item === currentItem}">
                   <div class="view">
                       <input type="checkbox" class="toggle" name="" id="" v-model="item.completed">
                       <label @dblclick="toEdit(item)">{{item.content}}</label>
                       <button class="destroy" :value="item.id" @click="removeItem(index)"></button>
                   </div>
                   <input class="edit" :value="item.content" @keyup.esc="cancelEdit" @keyup.enter="finishEdit(item,index,$event)" @blur="finishEdit(item,index,$event)">
               </li>
           </ul>
       </section>
       <footer class="footer" v-show="items.length">
            <span class="todo-count">
                <strong v-text="remaining"></strong>  {{pluralize('item',remaining)}} left
            </span>
            <button class="clear-completed" @click="removeCompleted" v-show="items.length > remaining">
                Clear completed
            </button>
       </footer>
   </section>

   <!-- <script src="node_modules/todomvc-common/base.js"></script> -->
    <!-- <script src="node_modules/director/build/director.js"></script> -->
    <script src="node_modules/vue/dist/vue.js"></script>
    <script src="js/store.js"></script>
    <!-- <script src="js/routes.js"></script> -->
    <script>
        
        new Vue({
            el: '#todoapp',
            data: {
                items: [],
                currentItem: null
            },
            methods: {
                addItem(event){
                    console.log('addItem' , event.target.value);
                    const content = event.target.value.trim();
                    if(!content.length){
                        return
                    }
                    const id = this.items.length + 1;
                    this.items.push(
                        {
                            id,
                            content,
                            completed: false
                        }
                    )
                    event.target.value = ''
                },
                pluralize(word,count){
                    return word + (count === 1 ? '' : 's')
                },
                removeItem(index){
                    console.log('index',index)
                    this.items.splice(index,1)
                },
                removeCompleted(){
                    this.items = this.items.filter(item => !item.completed)
                },
                toEdit(item){
                    this.currentItem = item
                },
                cancelEdit(){
                    this.currentItem = null
                },
                finishEdit(item,index,event){
                    const content = event.target.value.trim()
                    if(!content){
                        this.removeItem(index)
                        return
                    }
                    item.content = content
                    this.currentItem = null
                }
            },
            computed: {
                remaining(){
                    return this.items.filter(item => !item.completed).length
                },
                toggleAll: {
                    get(){
                        console.log('get',this.remaining)
                        return this.remaining === 0
                    },
                    set(newStatus){
                        this.items.forEach(item => {
                            item.completed = newStatus
                        });
                    }
                }
            }
        })
    </script>
</body>
</html>